import { NextRequest, NextResponse } from 'next/server';import { encodeFunctionData } from 'viem';const CONTRACT=process.env.NEXT_PUBLIC_PROOFMINT_CONTRACT as `0x${string}`;if(!CONTRACT){console.warn('NEXT_PUBLIC_PROOFMINT_CONTRACT not set');}const ABI=[{inputs:[{internalType:'address',name:'to',type:'address'},{internalType:'string',name:'uri',type:'string'}],name:'mintWithURI',outputs:[{internalType:'uint256',name:'',type:'uint256'}],stateMutability:'nonpayable',type:'function'}];export async function POST(req:NextRequest){try{const {uri}=await req.json();if(!uri)return NextResponse.json({error:'uri required'},{status:400});const data=encodeFunctionData({abi:ABI,functionName:'mintWithURI',args:['0x0000000000000000000000000000000000000000',uri] as any});return NextResponse.json({calls:[{to:CONTRACT,data,value:'0x0'}]});}catch(e:any){console.error(e);return NextResponse.json({error:e?.message||'Failed to build tx'},{status:500});}}